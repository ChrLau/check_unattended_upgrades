#! /bin/bash

setup() {
	. ./lib/test-helper.sh
	mock_path bin
	source_exec ../check_unattended_upgrades
}

test_check_unattended_upgrades() {
	_test() {
		case $@ in
			'-f /var/run/reboot-required')
				return 0
				;;

			'-f /var/log/unattended-upgrades/unattended-upgrades.log')
				exit 0
				;;

			'-x /usr/sbin/anacron')
				return 1
				;;
		esac
	}
	export -f _test
	fake_function test _test
	../check_unattended_upgrades || true
}
